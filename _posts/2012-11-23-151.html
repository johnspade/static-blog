---
layout: post
title: |-
  Пишем гаджет Windows 7
date: 2012-11-23 22:10:00
tags: 
  - проекты
  - софт
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Bnu5LYLWbUI/UK-76fkPo1I/AAAAAAAAE38/TorjMj9ubhE/s1600/1324670097_oficialnye-temy-i-gadzhety-dlya-windows-7%5B1%5D.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="363" src="http://1.bp.blogspot.com/-Bnu5LYLWbUI/UK-76fkPo1I/AAAAAAAAE38/TorjMj9ubhE/s400/1324670097_oficialnye-temy-i-gadzhety-dlya-windows-7%5B1%5D.jpg" width="400" /></a></div><br />Недавно в очередном альбоме с рабочими столами увидел у кого-то большую кнопку в центре экрана для запуска Dota 2 и понял, что хочу себе такую же, чтобы запускать любимую Counter-Strike Source, в которую играю больше всего. Обычно для этого используют лаунчеры для Rainmeter'а, я же не люблю использовать сторонние программы для оформления системы.<br /><br /><a name='more'></a>Так что я решил написать себе гаджет для рабочего стола, давно хотел это попробовать. Итак, что такое гаджет Windows 7? Это <b>.zip</b>-архив с расширением <b>.gadget</b>. Он обязательно должен содержать манифест - файл <b>gadget.xml</b>. А по сути гаджет является html-страничкой, к которой прикручиваются стили, скрипты и так далее. Мой гаджет будет самым простым - картинка с навешенной на нее ссылкой.<br /><br />Сначала создаем файл <b>gadget.xml</b>: <br /><br /><pre>&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />&lt;gadget&gt;<br />&lt;name&gt;CSS launcher&lt;/name&gt; <i>&lt;!-- Название гаджета --&gt;</i><br />&lt;version&gt;1.0&lt;/version&gt; &lt;!-- Версия гаджета --&gt;<br />&lt;author name="John Spade"&gt; <i>&lt;!-- Имя автора --&gt;</i><br />&lt;info url="johnspade.ru" /&gt; <i>&lt;!-- Ссылка на сайт --&gt;</i><br />&lt;/author&gt;<br />&lt;description&gt;Просто кнопка для запуска Counter-Strike Source&lt;/description&gt; <i>&lt;!-- Описание --&gt;</i><br />&lt;hosts&gt;<br />&lt;host name="sidebar"&gt;<br />&lt;base type="HTML" apiVersion="1.0.0" src="gadget.html" /&gt; <i>&lt;!-- Ссылка на html-файл --&gt;</i><br />&lt;permissions&gt;full&lt;/permissions&gt;<br />&lt;platform minPlatformVersion="0.3" /&gt;<br />&lt;/host&gt;<br />&lt;/hosts&gt;<br />&lt;/gadget&gt;<br /></pre><br />Permissions full,&nbsp;platform minPlatformVersion 0.3 и&nbsp;apiVersion 1.0.0 - обязательные параметры по спецификации.&nbsp;Название, имя автора и другая информация будут отображаться в центре управления гаджетами:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-f0dbLa8eUt4/UK-yfwmj4zI/AAAAAAAAE3k/CLqCY7jzKsk/s1600/Image+006.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="340" src="http://1.bp.blogspot.com/-f0dbLa8eUt4/UK-yfwmj4zI/AAAAAAAAE3k/CLqCY7jzKsk/s400/Image+006.png" width="400" /></a></div><br />Еще можно указать логотип гаджета, я этого не сделал.<br /><br />Теперь пишем сам гаджет, файл&nbsp;<b>gadget.html</b>:<br /><br /><pre>&lt;html&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;<br />&lt;style type="text/css"&gt;<br />body { <br />margin: 0px;<br />width: 230px;<br />height: 108px;<br />}<br />a img {<br />border: none;<br />}<br />&lt;/style&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;g:background opacity="0"&gt;&lt;/g:background&gt;<br />&lt;div&gt;&lt;a href="steam://rungameid/240"&gt;&lt;img src="image.jpg" width="230"&gt;&lt;/a&gt;&lt;/div&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></pre><br />Здесь я просто вставляю картинку, которая будет кнопкой и прикрепляю к ней ссылку. Ссылка не на ярлык игры, а на запуск приложения в Стиме. IE может спросить, действительно ли вы хотите запустить стороннее приложение для обработки ссылки, можно поставить галочку "Больше не спрашивать".<br /><br />Некоторые моменты в коде требуют пояснения. Стилевые параметры&nbsp;<b>margin</b> и <b>height</b> для body надо выставить обязательно, это размер гаджета. Я сделал его равным размеру картинки.&nbsp;<b>border: none</b> для&nbsp;<b>a img</b> убирает рамку вокруг картинок с ссылками, которую автоматически отображает Internet Explorer.&nbsp;<b>g:background</b> - специальный тег для управления фоном гаджета,&nbsp;<b>opacity="0"</b> делает его прозрачным.<br /><br />Далее запаковываем все файлы нашего гаджета в <b>.zip</b>-архив и изменяем его расширение на <b>.gadget</b>. Теперь запускаем этот файл и гаджет появится в Центре гаджетов и на рабочем столе:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-kpZ7IGw-eSw/UK-6Hv8Dh0I/AAAAAAAAE3s/oyjz0Hks8RM/s1600/Image+007.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-kpZ7IGw-eSw/UK-6Hv8Dh0I/AAAAAAAAE3s/oyjz0Hks8RM/s1600/Image+007.png" /></a></div><br />Сначала я хотел использовать милую кругленькую png-кнопку с прозрачностью, но в гаджете края таких картинок становятся розовыми О_о Я не знаю, в какую сторону копать, так что отказался от этой затеи.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-nbLDq4f6S5M/UK-6bY4fUSI/AAAAAAAAE30/05-tKeuzWDQ/s1600/Image+004.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-nbLDq4f6S5M/UK-6bY4fUSI/AAAAAAAAE30/05-tKeuzWDQ/s1600/Image+004.png" /></a></div><br />Если вам нужно, вы можете скачать мой гаджет:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://dl.dropbox.com/u/11765297/css.gadget" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-EV7JoXhWrio/TQ3HDPLexMI/AAAAAAAAC0k/tercWQVGBaE/s1600/Download.png" /></a></div><br />